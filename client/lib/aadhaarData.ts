// Complete dataset from CSV with state name normalization
const rawDataRaw = [
  {
    state: "Andaman and Nicobar Islands",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 39,
    Enrol_5_17: 4,
    Enrol_18_plus: 0,
    Demo_Updates: 64.0,
    Bio_Updates: 289.0,
    Total_Enrolment: 43,
    Biometric_Update_Rate: 6.72093023255814,
  },
  {
    state: "Andaman and Nicobar Islands",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 22,
    Enrol_5_17: 0,
    Enrol_18_plus: 0,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 22,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Andaman and Nicobar Islands",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 13,
    Enrol_5_17: 0,
    Enrol_18_plus: 0,
    Demo_Updates: 50.0,
    Bio_Updates: 101.0,
    Total_Enrolment: 13,
    Biometric_Update_Rate: 7.769230769230769,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 43,
    Enrol_5_17: 44,
    Enrol_18_plus: 29,
    Demo_Updates: 175264.0,
    Bio_Updates: 403296.0,
    Total_Enrolment: 116,
    Biometric_Update_Rate: 3476.689655172414,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 928,
    Enrol_5_17: 433,
    Enrol_18_plus: 213,
    Demo_Updates: 46035.0,
    Bio_Updates: 508472.0,
    Total_Enrolment: 1574,
    Biometric_Update_Rate: 323.04447268106736,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 473,
    Enrol_5_17: 372,
    Enrol_18_plus: 111,
    Demo_Updates: 28339.0,
    Bio_Updates: 334226.0,
    Total_Enrolment: 956,
    Biometric_Update_Rate: 349.60878661087867,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 34939,
    Enrol_5_17: 5037,
    Enrol_18_plus: 379,
    Demo_Updates: 62702.0,
    Bio_Updates: 141420.0,
    Total_Enrolment: 40355,
    Biometric_Update_Rate: 3.5043984636352374,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 23150,
    Enrol_5_17: 3085,
    Enrol_18_plus: 140,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 26375,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Andhra Pradesh",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 15568,
    Enrol_5_17: 1589,
    Enrol_18_plus: 178,
    Demo_Updates: 44637.0,
    Bio_Updates: 133631.0,
    Total_Enrolment: 17335,
    Biometric_Update_Rate: 7.708739544274589,
  },
  {
    state: "Arunachal Pradesh",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 89,
    Enrol_5_17: 352,
    Enrol_18_plus: 43,
    Demo_Updates: 0.0,
    Bio_Updates: 8442.0,
    Total_Enrolment: 484,
    Biometric_Update_Rate: 17.44214876033058,
  },
  {
    state: "Arunachal Pradesh",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 886,
    Enrol_5_17: 882,
    Enrol_18_plus: 6,
    Demo_Updates: 2944.0,
    Bio_Updates: 4856.0,
    Total_Enrolment: 1774,
    Biometric_Update_Rate: 2.737316798196167,
  },
  {
    state: "Arunachal Pradesh",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 387,
    Enrol_5_17: 473,
    Enrol_18_plus: 5,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 865,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Arunachal Pradesh",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 142,
    Enrol_5_17: 129,
    Enrol_18_plus: 87,
    Demo_Updates: 628.0,
    Bio_Updates: 2871.0,
    Total_Enrolment: 358,
    Biometric_Update_Rate: 8.019553072625698,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 587,
    Enrol_5_17: 1105,
    Enrol_18_plus: 800,
    Demo_Updates: 72993.0,
    Bio_Updates: 92931.0,
    Total_Enrolment: 2492,
    Biometric_Update_Rate: 37.29173354735153,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 11931,
    Enrol_5_17: 9203,
    Enrol_18_plus: 4520,
    Demo_Updates: 1685.0,
    Bio_Updates: 139659.0,
    Total_Enrolment: 25654,
    Biometric_Update_Rate: 5.443946363140251,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 5170,
    Enrol_5_17: 5609,
    Enrol_18_plus: 2418,
    Demo_Updates: 0.0,
    Bio_Updates: 83841.0,
    Total_Enrolment: 13197,
    Biometric_Update_Rate: 6.353034780631962,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 4878,
    Enrol_5_17: 3401,
    Enrol_18_plus: 1455,
    Demo_Updates: 1346.0,
    Bio_Updates: 71576.0,
    Total_Enrolment: 9734,
    Biometric_Update_Rate: 7.35319498664475,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 30769,
    Enrol_5_17: 11877,
    Enrol_18_plus: 5227,
    Demo_Updates: 14757.0,
    Bio_Updates: 95172.0,
    Total_Enrolment: 47873,
    Biometric_Update_Rate: 1.988009942974119,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 35699,
    Enrol_5_17: 14195,
    Enrol_18_plus: 745,
    Demo_Updates: 45505.0,
    Bio_Updates: 64830.0,
    Total_Enrolment: 50639,
    Biometric_Update_Rate: 1.2802385513142045,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 17597,
    Enrol_5_17: 7164,
    Enrol_18_plus: 2862,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 27623,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Assam",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 9771,
    Enrol_5_17: 4347,
    Enrol_18_plus: 1528,
    Demo_Updates: 16547.0,
    Bio_Updates: 40239.0,
    Total_Enrolment: 15646,
    Biometric_Update_Rate: 2.571839447782181,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 516,
    Enrol_5_17: 1392,
    Enrol_18_plus: 444,
    Demo_Updates: 409929.0,
    Bio_Updates: 763509.0,
    Total_Enrolment: 2352,
    Biometric_Update_Rate: 324.62117346938777,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 12551,
    Enrol_5_17: 15361,
    Enrol_18_plus: 1530,
    Demo_Updates: 7650.0,
    Bio_Updates: 795719.0,
    Total_Enrolment: 29442,
    Biometric_Update_Rate: 27.0266625908566,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 13251,
    Enrol_5_17: 17159,
    Enrol_18_plus: 1241,
    Demo_Updates: 5096.0,
    Bio_Updates: 552199.0,
    Total_Enrolment: 31651,
    Biometric_Update_Rate: 17.44649458152981,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 16160,
    Enrol_5_17: 28223,
    Enrol_18_plus: 2003,
    Demo_Updates: 0.0,
    Bio_Updates: 494457.0,
    Total_Enrolment: 46386,
    Biometric_Update_Rate: 10.65961712585694,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 19008,
    Enrol_5_17: 38019,
    Enrol_18_plus: 2247,
    Demo_Updates: 5924.0,
    Bio_Updates: 604061.0,
    Total_Enrolment: 59274,
    Biometric_Update_Rate: 10.190994365151669,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 62940,
    Enrol_5_17: 79583,
    Enrol_18_plus: 1042,
    Demo_Updates: 313035.0,
    Bio_Updates: 233922.0,
    Total_Enrolment: 143565,
    Biometric_Update_Rate: 1.629380420018807,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 46297,
    Enrol_5_17: 52921,
    Enrol_18_plus: 1691,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 100909,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Bihar",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 23870,
    Enrol_5_17: 24897,
    Enrol_18_plus: 436,
    Demo_Updates: 77827.0,
    Bio_Updates: 148392.0,
    Total_Enrolment: 49203,
    Biometric_Update_Rate: 3.015913663800988,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 181,
    Enrol_5_17: 102,
    Enrol_18_plus: 85,
    Demo_Updates: 133052.0,
    Bio_Updates: 164368.0,
    Total_Enrolment: 368,
    Biometric_Update_Rate: 446.6521739130435,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 4078,
    Enrol_5_17: 1495,
    Enrol_18_plus: 357,
    Demo_Updates: 131650.0,
    Bio_Updates: 273966.0,
    Total_Enrolment: 5930,
    Biometric_Update_Rate: 46.2,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 3687,
    Enrol_5_17: 1514,
    Enrol_18_plus: 380,
    Demo_Updates: 42953.0,
    Bio_Updates: 187658.0,
    Total_Enrolment: 5581,
    Biometric_Update_Rate: 33.62444006450457,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 5327,
    Enrol_5_17: 2371,
    Enrol_18_plus: 463,
    Demo_Updates: 47431.0,
    Bio_Updates: 136102.0,
    Total_Enrolment: 8161,
    Biometric_Update_Rate: 16.677122901605195,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 12568,
    Enrol_5_17: 5476,
    Enrol_18_plus: 740,
    Demo_Updates: 95586.0,
    Bio_Updates: 172708.0,
    Total_Enrolment: 18784,
    Biometric_Update_Rate: 9.194420783645656,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 13984,
    Enrol_5_17: 4475,
    Enrol_18_plus: 347,
    Demo_Updates: 19932.0,
    Bio_Updates: 62195.0,
    Total_Enrolment: 18806,
    Biometric_Update_Rate: 3.3071891949377856,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 8082,
    Enrol_5_17: 2132,
    Enrol_18_plus: 165,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 10379,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Delhi",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 6063,
    Enrol_5_17: 1479,
    Enrol_18_plus: 222,
    Demo_Updates: 7002.0,
    Bio_Updates: 28214.0,
    Total_Enrolment: 7764,
    Biometric_Update_Rate: 3.6339515713549715,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 686,
    Enrol_5_17: 354,
    Enrol_18_plus: 282,
    Demo_Updates: 175199.0,
    Bio_Updates: 396391.0,
    Total_Enrolment: 1322,
    Biometric_Update_Rate: 299.8419062027231,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 17603,
    Enrol_5_17: 6024,
    Enrol_18_plus: 4219,
    Demo_Updates: 21111.0,
    Bio_Updates: 374310.0,
    Total_Enrolment: 27846,
    Biometric_Update_Rate: 13.442146089204913,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 9005,
    Enrol_5_17: 3615,
    Enrol_18_plus: 1674,
    Demo_Updates: 62837.0,
    Bio_Updates: 452907.0,
    Total_Enrolment: 14294,
    Biometric_Update_Rate: 31.68511263467189,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 6275,
    Enrol_5_17: 5245,
    Enrol_18_plus: 704,
    Demo_Updates: 29439.0,
    Bio_Updates: 437361.0,
    Total_Enrolment: 12224,
    Biometric_Update_Rate: 35.778877617801044,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 33294,
    Enrol_5_17: 23945,
    Enrol_18_plus: 3594,
    Demo_Updates: 36025.0,
    Bio_Updates: 541874.0,
    Total_Enrolment: 60833,
    Biometric_Update_Rate: 8.90756661680338,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 44182,
    Enrol_5_17: 15179,
    Enrol_18_plus: 1203,
    Demo_Updates: 61529.0,
    Bio_Updates: 160991.0,
    Total_Enrolment: 60564,
    Biometric_Update_Rate: 2.6581962882240275,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 16172,
    Enrol_5_17: 4047,
    Enrol_18_plus: 1401,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 21620,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Gujarat",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 24042,
    Enrol_5_17: 5290,
    Enrol_18_plus: 865,
    Demo_Updates: 20221.0,
    Bio_Updates: 82273.0,
    Total_Enrolment: 30197,
    Biometric_Update_Rate: 2.7245421730635493,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 98,
    Enrol_5_17: 79,
    Enrol_18_plus: 23,
    Demo_Updates: 68826.0,
    Bio_Updates: 191374.0,
    Total_Enrolment: 200,
    Biometric_Update_Rate: 956.87,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 1785,
    Enrol_5_17: 482,
    Enrol_18_plus: 61,
    Demo_Updates: 59262.0,
    Bio_Updates: 216642.0,
    Total_Enrolment: 2328,
    Biometric_Update_Rate: 93.05927835051547,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 3039,
    Enrol_5_17: 601,
    Enrol_18_plus: 56,
    Demo_Updates: 38992.0,
    Bio_Updates: 170812.0,
    Total_Enrolment: 3696,
    Biometric_Update_Rate: 46.21536796536797,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 6112,
    Enrol_5_17: 1190,
    Enrol_18_plus: 339,
    Demo_Updates: 37184.0,
    Bio_Updates: 165272.0,
    Total_Enrolment: 7641,
    Biometric_Update_Rate: 21.62962962962963,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 5274,
    Enrol_5_17: 1301,
    Enrol_18_plus: 177,
    Demo_Updates: 33186.0,
    Bio_Updates: 267325.0,
    Total_Enrolment: 6752,
    Biometric_Update_Rate: 39.59197274881517,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 20658,
    Enrol_5_17: 1920,
    Enrol_18_plus: 123,
    Demo_Updates: 26461.0,
    Bio_Updates: 87770.0,
    Total_Enrolment: 22701,
    Biometric_Update_Rate: 3.8663495000220256,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 15119,
    Enrol_5_17: 1037,
    Enrol_18_plus: 51,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 16207,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Haryana",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 11914,
    Enrol_5_17: 882,
    Enrol_18_plus: 137,
    Demo_Updates: 11939.0,
    Bio_Updates: 53778.0,
    Total_Enrolment: 12933,
    Biometric_Update_Rate: 4.158199953607052,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 309,
    Enrol_5_17: 192,
    Enrol_18_plus: 231,
    Demo_Updates: 142442.0,
    Bio_Updates: 312129.0,
    Total_Enrolment: 732,
    Biometric_Update_Rate: 426.405737704918,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 7326,
    Enrol_5_17: 1165,
    Enrol_18_plus: 1095,
    Demo_Updates: 27633.0,
    Bio_Updates: 300403.0,
    Total_Enrolment: 9586,
    Biometric_Update_Rate: 31.337679949926976,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 2835,
    Enrol_5_17: 1758,
    Enrol_18_plus: 898,
    Demo_Updates: 47103.0,
    Bio_Updates: 354026.0,
    Total_Enrolment: 5491,
    Biometric_Update_Rate: 64.47386632671645,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 5863,
    Enrol_5_17: 3662,
    Enrol_18_plus: 2160,
    Demo_Updates: 32256.0,
    Bio_Updates: 337504.0,
    Total_Enrolment: 11685,
    Biometric_Update_Rate: 28.883525887890457,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 8654,
    Enrol_5_17: 4460,
    Enrol_18_plus: 2149,
    Demo_Updates: 27302.0,
    Bio_Updates: 374362.0,
    Total_Enrolment: 15263,
    Biometric_Update_Rate: 24.527419249164648,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 49282,
    Enrol_5_17: 8066,
    Enrol_18_plus: 1025,
    Demo_Updates: 58315.0,
    Bio_Updates: 126855.0,
    Total_Enrolment: 58373,
    Biometric_Update_Rate: 2.1731793808781457,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 30490,
    Enrol_5_17: 4785,
    Enrol_18_plus: 778,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 36053,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Karnataka",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 22596,
    Enrol_5_17: 2848,
    Enrol_18_plus: 580,
    Demo_Updates: 24111.0,
    Bio_Updates: 71090.0,
    Total_Enrolment: 26024,
    Biometric_Update_Rate: 2.7317091915155243,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 201,
    Enrol_5_17: 148,
    Enrol_18_plus: 31,
    Demo_Updates: 0.0,
    Bio_Updates: 247491.0,
    Total_Enrolment: 380,
    Biometric_Update_Rate: 651.2921052631579,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 85,
    Enrol_5_17: 80,
    Enrol_18_plus: 21,
    Demo_Updates: 0.0,
    Bio_Updates: 223183.0,
    Total_Enrolment: 186,
    Biometric_Update_Rate: 1199.9086021505377,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 158,
    Enrol_5_17: 216,
    Enrol_18_plus: 100,
    Demo_Updates: 0.0,
    Bio_Updates: 231320.0,
    Total_Enrolment: 474,
    Biometric_Update_Rate: 488.0168776371308,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 13659,
    Enrol_5_17: 5661,
    Enrol_18_plus: 179,
    Demo_Updates: 28797.0,
    Bio_Updates: 72952.0,
    Total_Enrolment: 19499,
    Biometric_Update_Rate: 3.741320067695779,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 12184,
    Enrol_5_17: 4404,
    Enrol_18_plus: 538,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 17126,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Kerala",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 8599,
    Enrol_5_17: 2486,
    Enrol_18_plus: 1066,
    Demo_Updates: 16040.0,
    Bio_Updates: 40890.0,
    Total_Enrolment: 12151,
    Biometric_Update_Rate: 3.3651551312649164,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 286,
    Enrol_5_17: 161,
    Enrol_18_plus: 95,
    Demo_Updates: 231673.0,
    Bio_Updates: 663358.0,
    Total_Enrolment: 542,
    Biometric_Update_Rate: 1223.9077490774907,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 12077,
    Enrol_5_17: 4146,
    Enrol_18_plus: 1128,
    Demo_Updates: 74179.0,
    Bio_Updates: 834670.0,
    Total_Enrolment: 17351,
    Biometric_Update_Rate: 48.10500835686704,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 7221,
    Enrol_5_17: 3018,
    Enrol_18_plus: 364,
    Demo_Updates: 116719.0,
    Bio_Updates: 779064.0,
    Total_Enrolment: 10603,
    Biometric_Update_Rate: 73.47580873337735,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 9708,
    Enrol_5_17: 7774,
    Enrol_18_plus: 672,
    Demo_Updates: 75021.0,
    Bio_Updates: 891131.0,
    Total_Enrolment: 18154,
    Biometric_Update_Rate: 49.08730858213066,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 34979,
    Enrol_5_17: 26040,
    Enrol_18_plus: 2169,
    Demo_Updates: 105375.0,
    Bio_Updates: 1004035.0,
    Total_Enrolment: 63188,
    Biometric_Update_Rate: 15.889646768373742,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 98016,
    Enrol_5_17: 33562,
    Enrol_18_plus: 939,
    Demo_Updates: 85625.0,
    Bio_Updates: 286081.0,
    Total_Enrolment: 132517,
    Biometric_Update_Rate: 2.158824905483825,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 50371,
    Enrol_5_17: 11943,
    Enrol_18_plus: 1311,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 63625,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Madhya Pradesh",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 40482,
    Enrol_5_17: 7557,
    Enrol_18_plus: 1096,
    Demo_Updates: 33105.0,
    Bio_Updates: 134655.0,
    Total_Enrolment: 49135,
    Biometric_Update_Rate: 2.740510837488552,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 232,
    Enrol_5_17: 130,
    Enrol_18_plus: 98,
    Demo_Updates: 262395.0,
    Bio_Updates: 959149.0,
    Total_Enrolment: 460,
    Biometric_Update_Rate: 2085.1065217391306,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 7986,
    Enrol_5_17: 1901,
    Enrol_18_plus: 704,
    Demo_Updates: 24988.0,
    Bio_Updates: 846049.0,
    Total_Enrolment: 10591,
    Biometric_Update_Rate: 79.88376923803229,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 6706,
    Enrol_5_17: 2352,
    Enrol_18_plus: 791,
    Demo_Updates: 33799.0,
    Bio_Updates: 947776.0,
    Total_Enrolment: 9849,
    Biometric_Update_Rate: 96.23068331810336,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 6521,
    Enrol_5_17: 3518,
    Enrol_18_plus: 610,
    Demo_Updates: 41493.0,
    Bio_Updates: 1017490.0,
    Total_Enrolment: 10649,
    Biometric_Update_Rate: 95.54793877359377,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 34468,
    Enrol_5_17: 18536,
    Enrol_18_plus: 1763,
    Demo_Updates: 58724.0,
    Bio_Updates: 1230369.0,
    Total_Enrolment: 54767,
    Biometric_Update_Rate: 22.465517556192598,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 73837,
    Enrol_5_17: 27751,
    Enrol_18_plus: 753,
    Demo_Updates: 92234.0,
    Bio_Updates: 505226.0,
    Total_Enrolment: 102341,
    Biometric_Update_Rate: 4.936692039358615,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 41040,
    Enrol_5_17: 9032,
    Enrol_18_plus: 933,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 51005,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Maharashtra",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 28548,
    Enrol_5_17: 5427,
    Enrol_18_plus: 1061,
    Demo_Updates: 164883.0,
    Bio_Updates: 381216.0,
    Total_Enrolment: 35036,
    Biometric_Update_Rate: 10.880694143167029,
  },
  {
    state: "Odisha",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 182,
    Enrol_5_17: 82,
    Enrol_18_plus: 12,
    Demo_Updates: 0.0,
    Bio_Updates: 290862.0,
    Total_Enrolment: 276,
    Biometric_Update_Rate: 1053.8478260869565,
  },
  {
    state: "Odisha",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 364,
    Enrol_5_17: 140,
    Enrol_18_plus: 25,
    Demo_Updates: 5316.0,
    Bio_Updates: 318143.0,
    Total_Enrolment: 529,
    Biometric_Update_Rate: 601.4045368620037,
  },
  {
    state: "Odisha",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 41417,
    Enrol_5_17: 10159,
    Enrol_18_plus: 51,
    Demo_Updates: 52426.0,
    Bio_Updates: 144224.0,
    Total_Enrolment: 51627,
    Biometric_Update_Rate: 2.793577004280706,
  },
  {
    state: "Odisha",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 18969,
    Enrol_5_17: 4473,
    Enrol_18_plus: 246,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 23688,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Odisha",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 9036,
    Enrol_5_17: 1968,
    Enrol_18_plus: 169,
    Demo_Updates: 14495.0,
    Bio_Updates: 62219.0,
    Total_Enrolment: 11173,
    Biometric_Update_Rate: 5.5686923834243265,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 118,
    Enrol_5_17: 28,
    Enrol_18_plus: 34,
    Demo_Updates: 50970.0,
    Bio_Updates: 260570.0,
    Total_Enrolment: 180,
    Biometric_Update_Rate: 1447.611111111111,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 3951,
    Enrol_5_17: 1155,
    Enrol_18_plus: 647,
    Demo_Updates: 10592.0,
    Bio_Updates: 212563.0,
    Total_Enrolment: 5753,
    Biometric_Update_Rate: 36.94820093864071,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 2540,
    Enrol_5_17: 1002,
    Enrol_18_plus: 225,
    Demo_Updates: 26137.0,
    Bio_Updates: 194508.0,
    Total_Enrolment: 3767,
    Biometric_Update_Rate: 51.63472259092116,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 1704,
    Enrol_5_17: 846,
    Enrol_18_plus: 192,
    Demo_Updates: 19240.0,
    Bio_Updates: 221505.0,
    Total_Enrolment: 2742,
    Biometric_Update_Rate: 80.78227571115974,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 5862,
    Enrol_5_17: 2132,
    Enrol_18_plus: 517,
    Demo_Updates: 42886.0,
    Bio_Updates: 277717.0,
    Total_Enrolment: 8511,
    Biometric_Update_Rate: 32.63036070966984,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 18622,
    Enrol_5_17: 2774,
    Enrol_18_plus: 171,
    Demo_Updates: 29595.0,
    Bio_Updates: 80163.0,
    Total_Enrolment: 21567,
    Biometric_Update_Rate: 3.716928640979274,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 8877,
    Enrol_5_17: 1404,
    Enrol_18_plus: 318,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 10599,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Punjab",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 5246,
    Enrol_5_17: 827,
    Enrol_18_plus: 350,
    Demo_Updates: 8870.0,
    Bio_Updates: 38382.0,
    Total_Enrolment: 6423,
    Biometric_Update_Rate: 5.9757122839794485,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 41,
    Enrol_5_17: 36,
    Enrol_18_plus: 17,
    Demo_Updates: 400058.0,
    Bio_Updates: 424206.0,
    Total_Enrolment: 94,
    Biometric_Update_Rate: 4512.829787234043,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 11907,
    Enrol_5_17: 4141,
    Enrol_18_plus: 794,
    Demo_Updates: 62812.0,
    Bio_Updates: 376914.0,
    Total_Enrolment: 16842,
    Biometric_Update_Rate: 22.379408621303885,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 1992,
    Enrol_5_17: 904,
    Enrol_18_plus: 65,
    Demo_Updates: 26898.0,
    Bio_Updates: 324061.0,
    Total_Enrolment: 2961,
    Biometric_Update_Rate: 109.44309354947653,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 4094,
    Enrol_5_17: 2354,
    Enrol_18_plus: 168,
    Demo_Updates: 29008.0,
    Bio_Updates: 416695.0,
    Total_Enrolment: 6616,
    Biometric_Update_Rate: 62.98292019347038,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 17372,
    Enrol_5_17: 10811,
    Enrol_18_plus: 603,
    Demo_Updates: 51281.0,
    Bio_Updates: 650116.0,
    Total_Enrolment: 28786,
    Biometric_Update_Rate: 22.584450774682136,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 84100,
    Enrol_5_17: 38908,
    Enrol_18_plus: 576,
    Demo_Updates: 77581.0,
    Bio_Updates: 404332.0,
    Total_Enrolment: 123584,
    Biometric_Update_Rate: 3.2717180217503885,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 28544,
    Enrol_5_17: 15085,
    Enrol_18_plus: 289,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 43918,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Rajasthan",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 24850,
    Enrol_5_17: 11742,
    Enrol_18_plus: 1933,
    Demo_Updates: 25683.0,
    Bio_Updates: 109520.0,
    Total_Enrolment: 38525,
    Biometric_Update_Rate: 2.8428293316028554,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 12,
    Enrol_5_17: 12,
    Enrol_18_plus: 10,
    Demo_Updates: 175423.0,
    Bio_Updates: 680675.0,
    Total_Enrolment: 34,
    Biometric_Update_Rate: 20019.852941176472,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 358,
    Enrol_5_17: 95,
    Enrol_18_plus: 46,
    Demo_Updates: 21447.0,
    Bio_Updates: 491490.0,
    Total_Enrolment: 499,
    Biometric_Update_Rate: 984.9498997995992,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 322,
    Enrol_5_17: 64,
    Enrol_18_plus: 34,
    Demo_Updates: 11832.0,
    Bio_Updates: 492262.0,
    Total_Enrolment: 420,
    Biometric_Update_Rate: 1172.0523809523809,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 1355,
    Enrol_5_17: 393,
    Enrol_18_plus: 183,
    Demo_Updates: 2153.0,
    Bio_Updates: 511757.0,
    Total_Enrolment: 1931,
    Biometric_Update_Rate: 265.02175038839977,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 630,
    Enrol_5_17: 273,
    Enrol_18_plus: 69,
    Demo_Updates: 10287.0,
    Bio_Updates: 552778.0,
    Total_Enrolment: 972,
    Biometric_Update_Rate: 568.701646090535,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 64432,
    Enrol_5_17: 11665,
    Enrol_18_plus: 111,
    Demo_Updates: 87671.0,
    Bio_Updates: 184650.0,
    Total_Enrolment: 76208,
    Biometric_Update_Rate: 2.422973965987823,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 34002,
    Enrol_5_17: 7488,
    Enrol_18_plus: 86,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 41576,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Tamil Nadu",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 22805,
    Enrol_5_17: 5239,
    Enrol_18_plus: 369,
    Demo_Updates: 42272.0,
    Bio_Updates: 241926.0,
    Total_Enrolment: 28413,
    Biometric_Update_Rate: 8.51462358779432,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 487,
    Enrol_5_17: 82,
    Enrol_18_plus: 65,
    Demo_Updates: 10479.0,
    Bio_Updates: 142160.0,
    Total_Enrolment: 634,
    Biometric_Update_Rate: 224.22712933753942,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 736,
    Enrol_5_17: 154,
    Enrol_18_plus: 21,
    Demo_Updates: 11178.0,
    Bio_Updates: 167061.0,
    Total_Enrolment: 911,
    Biometric_Update_Rate: 183.3819978046103,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 849,
    Enrol_5_17: 598,
    Enrol_18_plus: 69,
    Demo_Updates: 20329.0,
    Bio_Updates: 205116.0,
    Total_Enrolment: 1516,
    Biometric_Update_Rate: 135.30079155672823,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 6137,
    Enrol_5_17: 2168,
    Enrol_18_plus: 276,
    Demo_Updates: 35681.0,
    Bio_Updates: 226619.0,
    Total_Enrolment: 8581,
    Biometric_Update_Rate: 26.4093928446568,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 34798,
    Enrol_5_17: 8131,
    Enrol_18_plus: 153,
    Demo_Updates: 65939.0,
    Bio_Updates: 105902.0,
    Total_Enrolment: 43082,
    Biometric_Update_Rate: 2.4581495752286338,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 24956,
    Enrol_5_17: 5646,
    Enrol_18_plus: 136,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 30738,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Telangana",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 10916,
    Enrol_5_17: 2400,
    Enrol_18_plus: 156,
    Demo_Updates: 34913.0,
    Bio_Updates: 83817.0,
    Total_Enrolment: 13472,
    Biometric_Update_Rate: 6.221570665083135,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 165,
    Enrol_5_17: 81,
    Enrol_18_plus: 40,
    Demo_Updates: 0.0,
    Bio_Updates: 47615.0,
    Total_Enrolment: 286,
    Biometric_Update_Rate: 166.48601398601397,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 60,
    Enrol_5_17: 87,
    Enrol_18_plus: 20,
    Demo_Updates: 0.0,
    Bio_Updates: 32493.0,
    Total_Enrolment: 167,
    Biometric_Update_Rate: 194.5688622754491,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 359,
    Enrol_5_17: 264,
    Enrol_18_plus: 42,
    Demo_Updates: 0.0,
    Bio_Updates: 30667.0,
    Total_Enrolment: 665,
    Biometric_Update_Rate: 46.11578947368421,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 2027,
    Enrol_5_17: 1072,
    Enrol_18_plus: 22,
    Demo_Updates: 6471.0,
    Bio_Updates: 10800.0,
    Total_Enrolment: 3121,
    Biometric_Update_Rate: 3.4604293495674465,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 1240,
    Enrol_5_17: 586,
    Enrol_18_plus: 50,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 1876,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Tripura",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 917,
    Enrol_5_17: 491,
    Enrol_18_plus: 22,
    Demo_Updates: 2342.0,
    Bio_Updates: 9586.0,
    Total_Enrolment: 1430,
    Biometric_Update_Rate: 6.7034965034965035,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 1393,
    Enrol_5_17: 3326,
    Enrol_18_plus: 674,
    Demo_Updates: 735972.0,
    Bio_Updates: 1131504.0,
    Total_Enrolment: 5393,
    Biometric_Update_Rate: 209.80975338401632,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 32513,
    Enrol_5_17: 23189,
    Enrol_18_plus: 2201,
    Demo_Updates: 87664.0,
    Bio_Updates: 1257448.0,
    Total_Enrolment: 57903,
    Biometric_Update_Rate: 21.716456832979294,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 26928,
    Enrol_5_17: 21554,
    Enrol_18_plus: 1379,
    Demo_Updates: 65691.0,
    Bio_Updates: 1048878.0,
    Total_Enrolment: 49861,
    Biometric_Update_Rate: 21.03604019173302,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 21109,
    Enrol_5_17: 26080,
    Enrol_18_plus: 1564,
    Demo_Updates: 60692.0,
    Bio_Updates: 856455.0,
    Total_Enrolment: 48753,
    Biometric_Update_Rate: 17.567226632207248,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 73166,
    Enrol_5_17: 81078,
    Enrol_18_plus: 3622,
    Demo_Updates: 130100.0,
    Bio_Updates: 1426001.0,
    Total_Enrolment: 157866,
    Biometric_Update_Rate: 9.03298366969455,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 126150,
    Enrol_5_17: 132594,
    Enrol_18_plus: 2335,
    Demo_Updates: 334743.0,
    Bio_Updates: 499870.0,
    Total_Enrolment: 261079,
    Biometric_Update_Rate: 1.9146312035820576,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 70638,
    Enrol_5_17: 65271,
    Enrol_18_plus: 2243,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 138152,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "Uttar Pradesh",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 48503,
    Enrol_5_17: 35873,
    Enrol_18_plus: 1135,
    Demo_Updates: 131215.0,
    Bio_Updates: 342353.0,
    Total_Enrolment: 85511,
    Biometric_Update_Rate: 4.003613570183953,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 3.0,
    Enrol_0_5: 45,
    Enrol_5_17: 30,
    Enrol_18_plus: 46,
    Demo_Updates: 205205.0,
    Bio_Updates: 268875.0,
    Total_Enrolment: 121,
    Biometric_Update_Rate: 2222.1074380165287,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 4.0,
    Enrol_0_5: 2873,
    Enrol_5_17: 1014,
    Enrol_18_plus: 381,
    Demo_Updates: 21528.0,
    Bio_Updates: 250432.0,
    Total_Enrolment: 4268,
    Biometric_Update_Rate: 58.67666354264293,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 5.0,
    Enrol_0_5: 5538,
    Enrol_5_17: 3500,
    Enrol_18_plus: 544,
    Demo_Updates: 23795.0,
    Bio_Updates: 289260.0,
    Total_Enrolment: 9582,
    Biometric_Update_Rate: 30.18785222291797,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 6.0,
    Enrol_0_5: 3194,
    Enrol_5_17: 3323,
    Enrol_18_plus: 754,
    Demo_Updates: 36908.0,
    Bio_Updates: 287702.0,
    Total_Enrolment: 7271,
    Biometric_Update_Rate: 39.56842250034383,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 7.0,
    Enrol_0_5: 15274,
    Enrol_5_17: 11657,
    Enrol_18_plus: 1613,
    Demo_Updates: 57475.0,
    Bio_Updates: 419961.0,
    Total_Enrolment: 28544,
    Biometric_Update_Rate: 14.712759248878923,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 9.0,
    Enrol_0_5: 91183,
    Enrol_5_17: 27322,
    Enrol_18_plus: 1134,
    Demo_Updates: 218957.0,
    Bio_Updates: 184642.0,
    Total_Enrolment: 119639,
    Biometric_Update_Rate: 1.5433261729034846,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 10.0,
    Enrol_0_5: 60420,
    Enrol_5_17: 17268,
    Enrol_18_plus: 199,
    Demo_Updates: 0.0,
    Bio_Updates: 0.0,
    Total_Enrolment: 77887,
    Biometric_Update_Rate: 0.0,
  },
  {
    state: "West Bengal",
    Year: 2025.0,
    Month: 11.0,
    Enrol_0_5: 24524,
    Enrol_5_17: 7438,
    Enrol_18_plus: 103,
    Demo_Updates: 104069.0,
    Bio_Updates: 84074.0,
    Total_Enrolment: 32065,
    Biometric_Update_Rate: 2.6219865897395915,
  },
];

// Normalize state names to handle duplicates
function normalizeStateName(name: string): string {
  const normalized = name.trim();

  // Handle state name variations
  const stateMap: { [key: string]: string } = {
    odisha: "Odisha",
    orissa: "Odisha",
    pondicherry: "Puducherry",
    "west bengal": "West Bengal",
    "west bangal": "West Bengal",
    westbengal: "West Bengal",
    "jammu & kashmir": "Jammu and Kashmir",
    "jammu and kashmir": "Jammu and Kashmir",
    "daman & diu": "Daman and Diu",
    "daman and diu": "Daman and Diu",
    "dadra & nagar haveli": "Dadra and Nagar Haveli",
    "dadra and nagar haveli": "Dadra and Nagar Haveli",
    "the dadra and nagar haveli and daman and diu":
      "Dadra and Nagar Haveli and Daman and Diu",
    "dadra and nagar haveli and daman and diu":
      "Dadra and Nagar Haveli and Daman and Diu",
  };

  const lower = normalized.toLowerCase();
  return stateMap[lower] || normalized;
}

const rawData = rawDataRaw.map((d) => ({
  ...d,
  state: normalizeStateName(d.state),
}));

export interface StateData {
  state: string;
  totalEnrolments: number;
  healthScore: number;
  eqi: number;
  frictionIndex: number;
  bioUpdateRate: number;
  demoUpdateRate: number;
  childEnrolmentRatio: number;
}

export interface TimeSeriesData {
  month: string;
  totalEnrolments: number;
  bioUpdates: number;
  demoUpdates: number;
}

export interface StateTimeSeriesData {
  state: string;
  data: TimeSeriesData[];
}

// Calculate Health Score based on metrics
function calculateHealthScore(
  eqi: number,
  frictionIndex: number,
  cerRatio: number,
): number {
  // Health Score = (0.4 × EQI + 0.4 × (1 - Friction) + 0.2 × CER) × 100
  const score = (0.4 * eqi + 0.4 * (1 - frictionIndex) + 0.2 * cerRatio) * 100;
  return Math.max(0, Math.min(100, score));
}

// Calculate EQI (Enrolment Quality Index) - realistic based on update rates
function calculateEQI(bioUpdates: number, totalEnrolments: number): number {
  if (totalEnrolments === 0) return 0.5;

  // EQI is inversely proportional to biometric update rate
  // High update rate (>200%) = very poor quality (EQI close to 0)
  // Low update rate (<10%) = excellent quality (EQI close to 1)

  const updateRate = (bioUpdates / Math.max(1, totalEnrolments)) * 100; // Convert to percentage

  // Linear scale mapped to realistic ranges:
  // 0-10% update rate -> EQI 0.9-1.0 (excellent)
  // 10-50% update rate -> EQI 0.7-0.9 (good)
  // 50-100% update rate -> EQI 0.5-0.7 (average)
  // 100-300% update rate -> EQI 0.2-0.5 (poor)
  // 300%+ update rate -> EQI 0-0.2 (critical)

  if (updateRate <= 10) {
    return 0.95;
  } else if (updateRate <= 50) {
    return 0.95 - ((updateRate - 10) / 40) * 0.25;
  } else if (updateRate <= 100) {
    return 0.70 - ((updateRate - 50) / 50) * 0.20;
  } else if (updateRate <= 300) {
    return 0.50 - ((updateRate - 100) / 200) * 0.30;
  } else {
    return Math.max(0, 0.20 - ((updateRate - 300) / 500) * 0.20);
  }
}

// Calculate Friction Index - realistic based on update rates
function calculateFrictionIndex(
  bioUpdates: number,
  totalEnrolments: number,
): number {
  if (totalEnrolments === 0) return 0.5;

  // Friction index measures operational difficulty
  // High update rates = citizens facing challenges = high friction
  const updateRate = (bioUpdates / Math.max(1, totalEnrolments)) * 100; // Convert to percentage

  // Direct mapping to friction:
  // 0-20% -> Low friction (0.1-0.2)
  // 20-100% -> Medium friction (0.2-0.5)
  // 100-300% -> High friction (0.5-0.8)
  // 300%+ -> Very high friction (0.8+)

  if (updateRate <= 20) {
    return 0.15;
  } else if (updateRate <= 100) {
    return 0.15 + ((updateRate - 20) / 80) * 0.35;
  } else if (updateRate <= 300) {
    return 0.50 + ((updateRate - 100) / 200) * 0.30;
  } else {
    return Math.min(1, 0.80 + ((updateRate - 300) / 500) * 0.20);
  }
}

// Calculate CER (Child Enrolment Ratio)
function calculateCER(
  childEnrolments: number,
  totalEnrolments: number,
): number {
  if (totalEnrolments === 0) return 0;
  return Math.min(1, childEnrolments / totalEnrolments);
}

// Aggregate data by state
export function getStateMetrics(): StateData[] {
  const stateMap = new Map<string, any>();

  rawData.forEach((record) => {
    const state = normalizeStateName(record.state);

    if (!stateMap.has(state)) {
      stateMap.set(state, {
        state,
        totalEnrolments: 0,
        totalBioUpdates: 0,
        totalDemoUpdates: 0,
        childEnrolments: 0,
        records: [],
      });
    }

    const existing = stateMap.get(state);
    existing.totalEnrolments += record.Total_Enrolment || 0;
    existing.totalBioUpdates += record.Bio_Updates || 0;
    existing.totalDemoUpdates += record.Demo_Updates || 0;
    existing.childEnrolments += record.Enrol_0_5 + record.Enrol_5_17 || 0;
    existing.records.push(record);
  });

  // Convert to StateData with calculated metrics
  const results: StateData[] = [];
  stateMap.forEach((aggregate) => {
    const eqi = calculateEQI(
      aggregate.totalBioUpdates,
      aggregate.totalEnrolments,
    );
    const frictionIndex = calculateFrictionIndex(
      aggregate.totalBioUpdates,
      aggregate.totalEnrolments,
    );
    const cerRatio = calculateCER(
      aggregate.childEnrolments,
      aggregate.totalEnrolments,
    );
    const healthScore = calculateHealthScore(eqi, frictionIndex, cerRatio);

    results.push({
      state: aggregate.state,
      totalEnrolments: aggregate.totalEnrolments,
      healthScore,
      eqi: Math.max(0, Math.min(1, eqi)),
      frictionIndex: Math.max(0, Math.min(1, frictionIndex)),
      bioUpdateRate: aggregate.records[0]?.Biometric_Update_Rate || 0,
      demoUpdateRate:
        aggregate.totalDemoUpdates / Math.max(1, aggregate.totalEnrolments),
      childEnrolmentRatio: cerRatio,
    });
  });

  // Sort by health score descending
  return results.sort((a, b) => b.healthScore - a.healthScore);
}

// Get time series data for a specific state
export function getStateTimeSeries(stateName: string): TimeSeriesData[] {
  const normalizedName = normalizeStateName(stateName);
  const stateRecords = rawData.filter(
    (r) => normalizeStateName(r.state) === normalizedName,
  );

  const monthMap = new Map<number, TimeSeriesData>();

  stateRecords.forEach((record) => {
    const month = Math.round(record.Month);
    if (!monthMap.has(month)) {
      monthMap.set(month, {
        month: getMonthName(month),
        totalEnrolments: 0,
        bioUpdates: 0,
        demoUpdates: 0,
      });
    }

    const existing = monthMap.get(month)!;
    existing.totalEnrolments += record.Total_Enrolment || 0;
    existing.bioUpdates += record.Bio_Updates || 0;
    existing.demoUpdates += record.Demo_Updates || 0;
  });

  return Array.from(monthMap.values()).sort((a, b) => {
    const monthOrder: { [key: string]: number } = {
      January: 1,
      February: 2,
      March: 3,
      April: 4,
      May: 5,
      June: 6,
      July: 7,
      August: 8,
      September: 9,
      October: 10,
      November: 11,
      December: 12,
    };
    return (monthOrder[a.month] || 0) - (monthOrder[b.month] || 0);
  });
}

function getMonthName(month: number): string {
  const months = [
    "",
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December",
  ];
  return months[month] || `Month ${month}`;
}

// Get top and bottom performers
export function getTopPerformers(count: number = 5): StateData[] {
  return getStateMetrics().slice(0, count);
}

export function getBottomPerformers(count: number = 5): StateData[] {
  const metrics = getStateMetrics();
  return metrics.slice(Math.max(0, metrics.length - count)).reverse();
}

// Get aggregate statistics
export function getAggregateStats() {
  const metrics = getStateMetrics();
  const totalEnrolments = metrics.reduce(
    (sum, s) => sum + s.totalEnrolments,
    0,
  );
  const avgHealthScore =
    metrics.reduce((sum, s) => sum + s.healthScore, 0) / metrics.length;
  const criticalStates = metrics.filter((s) => s.healthScore < 45).length;
  const totalStates = metrics.length;

  return {
    totalStates,
    totalEnrolments,
    avgHealthScore: parseFloat(avgHealthScore.toFixed(1)),
    criticalStates,
    anomalies: Math.floor(
      metrics.filter((s) => s.healthScore < 50).length * 2.5,
    ),
  };
}
